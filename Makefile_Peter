# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: tpuma <tpuma@student.42.fr>                +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/12/03 14:12:19 by tpuma             #+#    #+#              #
#    Updated: 2022/12/11 18:26:27 by tpuma            ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# -----------VARIABLES----------

NAME = so_long

SRC_DIR := .

SRC = so_long.c

OBJ = so_long.o

OBJS = $(SRC:%.c=%.o)


GNL = gnl
GNL_DIR = ../srcs/gnl
GNL_RULE = $(GNL_DIR)/lib$(GNL).a
GNL_L = -L $(GNL_DIR)
GNL_H = -I $(GNL_DIR)
GNL_A = -l $(GNL)

INCLUDES = so_long.h 
LIBS_DIR = $(GNL_L)
LIBS = $(GNL_A)

OSRC = $(CSRC:%.c=%.o)

CC = gcc
CFLAGS = -Wall -Werror -Wextra -g3
# -----------REGLASS----------

all: $(NAME)


$(NAME): $(GNL_RULE) $(OBJ)
	@$(GCCCMD) $(CFLAGS) -Imlx -Iso_long.h -lmlx -framework OpenGL -framework AppKit $^ -o $@
	$(CC) $(CFLAGS) $(OBJ) -o $(NAME) $(INCLUDES) $(LIBS_DIR)

$(GNL_RULE):

$(OBJ): $(SRCS)
	$(CC) $(CFLAGS) c $< -o $@

$(MLX_RULE):
	@make -C mlx


	@$(GCCCMD) $(CFLAGS) -Imlx -c $^ -o $@
	@echo "$(MAGENTA)Compilation mlx finished$(RESET)"

# -----------FUNCIONES----------

clean:
	@make -C mlx/ clean
	@rm -f $(OSRC)

	@echo "$(GREEN)cleaning finished$(RESET)"

fclean: clean
	@rm -f $(NAME)
	@echo "$(GREEN)forced cleaning finished$(RESET)"

re: fclean all

.PHONY: all clean fclean re
